version: 2
defaults:
  working_directory: /tmp
jobs:
  build:
    docker:
      - image: circleci/node:chakracore-8.11.1
    steps:
      - checkout
      - run:
          name: Make build directory
          command: mkdir /tmp/workspace
      - run:
          name: Copy all to the workspace directory
          command: cp -r * /tmp/workspace
      - persist_to_workspace:
          root: /tmp/workspace
          paths:
            - *
    
  # deploy:
  #   docker:
  #     - image: google/cloud-sdk
  #       environment:
  #         STORAGE_BUCKET: website.com
  #   steps:
  #     - attach_workspace:
  #         at: /tmp/workspace
  #     - run:
  #         name: Initialize gcloud
  #         command: /tmp/workspace/build/authgcloud.sh
  #     - run:
  #         name: list files
  #         command: ls /tmp/workspace/dist
  #     - run:
  #         name: deploy
  #         command: /tmp/workspace/build/deploy.sh
workflows:
  version: 2
  build_deploy:
    jobs:
      - build
      - deploy:
          requires:
            - build
          filters:
            branches:
              only: master
